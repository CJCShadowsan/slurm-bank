usage() 
{
	echo "usage: sbank balance statement [flags] args"
	echo "        -c display per cluster 'clustername' (defaults to the local cluster)"
	echo "        -a display per account 'accountname' (defaults to all accounts of the current user; implies '
-u')"
	echo "         -u show all users in the account (defaults to just the current user)"
	echo "         -A display all accounts (defaults to all accounts of the current user; implies '-u')"
	echo
	echo "       sbank balance estimate [flags] args"
	echo "        -n specify total number of nodes"
	echo "        -c specify total number of cores per node"
	echo "        -t specify total time in hours"
}

parse_args() {
        # parse options
        FLAGS "$@" || exit $?
        eval set -- "${FLAGS_ARGV}"
}

cmd_default()
{
	cmd_statement "$@"
}

cmd_statement()
{
	local opts

	# define some variables
	debug "define some variables"
	DEFINE_string 'account' '' 'specify a slurm account' 'a'
	DEFINE_string 'cluster' '' 'specify a cluster' 'c'
	DEFINE_string 'user' '' 'specify a user' 'u'
	DEFINE_boolean 'all' false 'show all users in the account' 'A'

	FLAGS_PARENT="sbank balance"

	# parse the command line
	debug "parse command line"
	parse_args "$@"

	# change behaviour of getopt to let perl program take args
	unset POSIXLY_CORRECT


	[ "${FLAGS_cluster}" != "" ]  && opts="$opts -c ${FLAGS_cluster}"
	[ "${FLAGS_account}" != "" ]  && opts="$opts -a ${FLAGS_account}"
	[ "${FLAGS_user}" != "" ]  && opts="$opts -u ${FLAGS_user}"
	[ ${FLAGS_all} -eq ${FLAGS_TRUE} ] && opts="$opts -A"

	sbalance $opts
}

cmd_estimate()
{
	# define some variables
        debug "define some variables"
        DEFINE_integer 'nodes' '0' 'specify a total number of nodes' 'n'
        DEFINE_integer 'cores' '0' 'specify a total number of cores per node' 'c'
        DEFINE_integer 'time' '0' 'specify a total hours (Walltime)' 't'

	FLAGS_PARENT="sbank balance request"

        # parse the command line
        debug "parse command line"
        parse_args "$@"

	# get account balance and substract estimate of total cores *
	# walltime and return a value to the user

	debug "nodes=${FLAGS_nodes} "
	debug "cores=${FLAGS_cores} "
	debug "time=${FLAGS_time} "
	debug "requested=$(( ${FLAGS_nodes} * ${FLAGS_cores} * ${FLAGS_time} )) \n"

	[ "${FLAGS_nodes}" -le "0" ] && die "nodes must be greater than 0"
	[ "${FLAGS_cores}" -le "0" ] && die "cores must be greater than 0"
	[ "${FLAGS_time}" -le "0" ] && die "time must be greater than 0"

	printf "estimate=$(( ${FLAGS_nodes} * ${FLAGS_cores} * ${FLAGS_time} )) \n"
}

cmd_help()
{
	usage
	exit 0
}
